(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{3168:(e,t,r)=>{"use strict";r.d(t,{Dv:()=>l,mB:()=>a,tn:()=>n,us:()=>o,y1:()=>i});let s=(0,r(5647).UU)("https://rtajuzunzkoamruejtim.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ0YWp1enVuemtvYW1ydWVqdGltIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxNDA0MTMsImV4cCI6MjA2OTcxNjQxM30.dlestmqzHPy-zMeJubohj13dvPaZ7MEUeoRti5OF0uU"),a={async getAll(){let{data:e,error:t}=await s.from("equipamentos").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async create(e){let{data:t,error:r}=await s.from("equipamentos").insert([e]).select();if(r)throw r;return null==t?void 0:t[0]},async update(e,t){let{data:r,error:a}=await s.from("equipamentos").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select();if(a)throw a;return null==r?void 0:r[0]},async delete(e){let{error:t}=await s.from("equipamentos").delete().eq("id",e);if(t)throw t},async checkCodeExists(e){let{data:t,error:r}=await s.from("equipamentos").select("id").eq("codigo",e).limit(1);if(r)throw r;return((null==t?void 0:t.length)||0)>0}},n={async getAll(){let{data:e,error:t}=await s.from("equipamentos_utilizados").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async create(e){let{data:t,error:r}=await s.from("equipamentos_utilizados").insert([e]).select();if(r)throw r;return null==t?void 0:t[0]},async return(e){let{error:t}=await s.from("equipamentos_utilizados").delete().eq("id",e);if(t)throw t}},i={async signIn(e,t){let{data:r,error:a}=await s.auth.signInWithPassword({email:e,password:t});if(a)throw a;return r},async signUp(e,t,r){let{data:a,error:n}=await s.auth.signUp({email:e,password:t,options:{data:{nome:r}}});if(n)throw n;return a},async signOut(){let{error:e}=await s.auth.signOut();if(e)throw e},async getCurrentUser(){let{data:{user:e}}=await s.auth.getUser();return e},async getSession(){let{data:{session:e}}=await s.auth.getSession();return e}},l={async createProfile(e){let{data:t,error:r}=await s.from("user_profiles").insert([e]).select();if(r)throw r;return null==t?void 0:t[0]},async getProfile(e){let{data:t,error:r}=await s.from("user_profiles").select("*").eq("id",e).single();if(r)throw r;return t},async getAllUsers(){let{data:e,error:t}=await s.from("user_profiles").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async approveUser(e,t){let{data:r,error:a}=await s.from("user_profiles").update({status:"approved",approved_at:new Date().toISOString(),approved_by:t}).eq("id",e).select();if(a)throw a;return null==r?void 0:r[0]},async deactivateUser(e){let{data:t,error:r}=await s.from("user_profiles").update({status:"inactive"}).eq("id",e).select();if(r)throw r;return null==t?void 0:t[0]},async activateUser(e){let{data:t,error:r}=await s.from("user_profiles").update({status:"approved"}).eq("id",e).select();if(r)throw r;return null==t?void 0:t[0]},async isAdmin(e){let t=await this.getProfile(e);return(null==t?void 0:t.role)==="admin"&&(null==t?void 0:t.status)==="approved"}},o={async getByUser(e){let{data:t,error:r}=await s.from("equipamentos").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]},async getAllForAdmin(){let{data:e,error:t}=await s.from("equipamentos").select("\n        *,\n        user_profiles!equipamentos_user_id_fkey(nome, email)\n      ").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async create(e){let{data:t,error:r}=await s.from("equipamentos").insert([e]).select();if(r)throw r;return null==t?void 0:t[0]},async checkCodeExistsForUser(e,t){let{data:r,error:a}=await s.from("equipamentos").select("id").eq("codigo",e).eq("user_id",t).limit(1);if(a)throw a;return((null==r?void 0:r.length)||0)>0}}},3434:(e,t,r)=>{Promise.resolve().then(r.bind(r,5781))},5781:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),a=r(2115),n=r(6874),i=r.n(n),l=r(5695),o=r(3168);function d(){let e=(0,l.useRouter)(),[t,r]=(0,a.useState)({nome:"",email:"",password:"",confirmPassword:""}),[n,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{await o.y1.getSession()&&e.push("/")})()},[e]);let f=async e=>{if(e.preventDefault(),d(!0),u(null),t.password!==t.confirmPassword){u("As senhas n\xe3o coincidem"),d(!1);return}if(t.password.length<6){u("A senha deve ter pelo menos 6 caracteres"),d(!1);return}try{await o.y1.signUp(t.email,t.password,t.nome),x(!0)}catch(e){u(e.message||"Erro ao criar conta")}finally{d(!1)}},h=e=>{r(t=>({...t,[e.target.name]:e.target.value}))};return m?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100 flex items-center justify-center p-4",children:(0,s.jsx)("div",{className:"max-w-md w-full",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("i",{className:"ri-check-circle-line text-green-500 text-2xl"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Cadastro Realizado!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Sua conta foi criada com sucesso. Aguarde a aprova\xe7\xe3o do administrador para acessar o sistema."}),(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("i",{className:"ri-time-line text-yellow-500 text-xl"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"font-medium text-yellow-800",children:"Aguardando Aprova\xe7\xe3o"}),(0,s.jsx)("p",{className:"text-sm text-yellow-600",children:"O administrador ser\xe1 notificado e aprovar\xe1 sua conta em breve."})]})]})}),(0,s.jsx)(i(),{href:"/login",children:(0,s.jsx)("button",{className:"w-full bg-blue-500 text-white py-3 rounded-xl font-medium hover:bg-blue-600 transition-colors",children:"Voltar ao Login"})})]})})}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full",children:[(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("i",{className:"ri-user-add-line text-green-500 text-2xl"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Criar Conta"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Cadastre-se no Sistema de Controle de Estoque"})]}),c&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-100 border border-red-200 rounded-xl",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("i",{className:"ri-error-warning-line text-red-500 text-xl"}),(0,s.jsx)("p",{className:"text-red-800 text-sm",children:c})]})}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),(0,s.jsx)("input",{type:"text",name:"nome",value:t.nome,onChange:h,placeholder:"Seu nome completo",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,s.jsx)("input",{type:"email",name:"email",value:t.email,onChange:h,placeholder:"seu@email.com",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),(0,s.jsx)("input",{type:"password",name:"password",value:t.password,onChange:h,placeholder:"••••••••",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,minLength:6})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Senha"}),(0,s.jsx)("input",{type:"password",name:"confirmPassword",value:t.confirmPassword,onChange:h,placeholder:"••••••••",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,minLength:6})]}),(0,s.jsx)("button",{type:"submit",disabled:n,className:"w-full bg-green-500 text-white py-3 rounded-xl font-medium shadow-lg hover:bg-green-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Criando conta..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("i",{className:"ri-user-add-line text-xl"}),"Criar Conta"]})})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsxs)("p",{className:"text-gray-600",children:["J\xe1 tem uma conta?"," ",(0,s.jsx)(i(),{href:"/login",className:"text-green-500 hover:text-green-600 font-medium",children:"Fa\xe7a login"})]})})]}),(0,s.jsx)("div",{className:"mt-6 bg-white/50 backdrop-blur rounded-xl p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,s.jsx)("i",{className:"ri-information-line text-blue-500"})," Processo de Aprova\xe7\xe3o"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Ap\xf3s o cadastro, sua conta ser\xe1 analisada pelo administrador.",(0,s.jsx)("br",{}),"Voc\xea receber\xe1 acesso assim que for aprovado."]})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[754,441,684,358],()=>t(3434)),_N_E=e.O()}]);