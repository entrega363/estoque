(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{3168:(e,t,s)=>{"use strict";s.d(t,{Dv:()=>n,mB:()=>a,tn:()=>i,us:()=>o,y1:()=>l});let r=(0,s(5647).UU)("https://thtknmmhtfjikzxznjxi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRodGtubW1odGZqaWt6eHpuanhpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1OTU0MjYsImV4cCI6MjA2ODE3MTQyNn0.Aex9osM2zlneafmSUtmeOt-4pEFOB4JOIeqQdvdKSkA"),a={async getAll(){let{data:e,error:t}=await r.from("equipamentos").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async create(e){let{data:t,error:s}=await r.from("equipamentos").insert([e]).select();if(s)throw s;return null==t?void 0:t[0]},async update(e,t){let{data:s,error:a}=await r.from("equipamentos").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select();if(a)throw a;return null==s?void 0:s[0]},async delete(e){let{error:t}=await r.from("equipamentos").delete().eq("id",e);if(t)throw t},async checkCodeExists(e){let{data:t,error:s}=await r.from("equipamentos").select("id").eq("codigo",e).limit(1);if(s)throw s;return((null==t?void 0:t.length)||0)>0}},i={async getAll(){let{data:e,error:t}=await r.from("equipamentos_utilizados").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async create(e){let{data:t,error:s}=await r.from("equipamentos_utilizados").insert([e]).select();if(s)throw s;return null==t?void 0:t[0]},async return(e){let{error:t}=await r.from("equipamentos_utilizados").delete().eq("id",e);if(t)throw t}},l={async signIn(e,t){let{data:s,error:a}=await r.auth.signInWithPassword({email:e,password:t});if(a)throw a;return s},async signUp(e,t,s){let{data:a,error:i}=await r.auth.signUp({email:e,password:t,options:{data:{nome:s}}});if(i)throw i;return a},async signOut(){let{error:e}=await r.auth.signOut();if(e)throw e},async getCurrentUser(){let{data:{user:e}}=await r.auth.getUser();return e},async getSession(){let{data:{session:e}}=await r.auth.getSession();return e}},n={async createProfile(e){let{data:t,error:s}=await r.from("user_profiles").insert([e]).select();if(s)throw s;return null==t?void 0:t[0]},async getProfile(e){let{data:t,error:s}=await r.from("user_profiles").select("*").eq("id",e).single();if(s)throw s;return t},async getAllUsers(){let{data:e,error:t}=await r.from("user_profiles").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async approveUser(e,t){let{data:s,error:a}=await r.from("user_profiles").update({status:"approved",approved_at:new Date().toISOString(),approved_by:t}).eq("id",e).select();if(a)throw a;return null==s?void 0:s[0]},async deactivateUser(e){let{data:t,error:s}=await r.from("user_profiles").update({status:"inactive"}).eq("id",e).select();if(s)throw s;return null==t?void 0:t[0]},async activateUser(e){let{data:t,error:s}=await r.from("user_profiles").update({status:"approved"}).eq("id",e).select();if(s)throw s;return null==t?void 0:t[0]},async isAdmin(e){let t=await this.getProfile(e);return(null==t?void 0:t.role)==="admin"&&(null==t?void 0:t.status)==="approved"}},o={async getByUser(e){let{data:t,error:s}=await r.from("equipamentos").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(s)throw s;return t||[]},async getAllForAdmin(){let{data:e,error:t}=await r.from("equipamentos").select("\n        *,\n        user_profiles!equipamentos_user_id_fkey(nome, email)\n      ").order("created_at",{ascending:!1});if(t)throw t;return e||[]},async create(e){let{data:t,error:s}=await r.from("equipamentos").insert([e]).select();if(s)throw s;return null==t?void 0:t[0]},async checkCodeExistsForUser(e,t){let{data:s,error:a}=await r.from("equipamentos").select("id").eq("codigo",e).eq("user_id",t).limit(1);if(a)throw a;return((null==s?void 0:s.length)||0)>0}}},5052:(e,t,s)=>{Promise.resolve().then(s.bind(s,8007))},8007:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(5155),a=s(2115),i=s(6874),l=s.n(i),n=s(5695),o=s(3168);function d(){(0,n.useRouter)();let[e,t]=(0,a.useState)({email:"",password:""}),[s,i]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await o.y1.getSession();(null==t?void 0:t.user)&&e&&(console.log("✅ Usu\xe1rio j\xe1 est\xe1 logado:",t.user.email),m(!0))}catch(e){console.log("ℹ️ Nenhuma sess\xe3o ativa, permanecendo na p\xe1gina de login")}})(),()=>{e=!1}},[]);let x=async t=>{t.preventDefault(),i(!0),c(null);try{var s;let t=await o.y1.signIn(e.email,e.password);console.log("✅ Login realizado com sucesso!",null==(s=t.user)?void 0:s.email),m(!0),setTimeout(()=>{p()},1e3)}catch(e){console.error("❌ Erro no login:",e),c(e.message||"Erro ao fazer login. Verifique suas credenciais.")}finally{i(!1)}},p=()=>{console.log("\uD83C\uDFE0 Redirecionando para a p\xe1gina principal..."),window.location.href="/"},h=e=>{t(t=>({...t,[e.target.name]:e.target.value}))};return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"max-w-md w-full",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-user-line text-blue-500 text-2xl"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Fazer Login"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Acesse o Sistema de Controle de Estoque"})]}),d&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-100 border border-red-200 rounded-xl",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("i",{className:"ri-error-warning-line text-red-500 text-xl"}),(0,r.jsx)("p",{className:"text-red-800 text-sm",children:d})]})}),u&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-green-100 border border-green-200 rounded-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("i",{className:"ri-check-circle-line text-green-500 text-xl"}),(0,r.jsx)("p",{className:"text-green-800 text-sm",children:"Login realizado com sucesso!"})]}),(0,r.jsxs)("button",{onClick:p,className:"w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)("i",{className:"ri-home-line"}),"Ir para o Sistema"]})]}),(0,r.jsxs)("form",{onSubmit:x,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",value:e.email,onChange:h,placeholder:"seu@email.com",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),(0,r.jsx)("input",{type:"password",name:"password",value:e.password,onChange:h,placeholder:"••••••••",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:s,className:"w-full bg-blue-500 text-white py-3 rounded-xl font-medium shadow-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"ri-login-circle-line text-xl"}),"Entrar"]})})]}),(0,r.jsxs)("div",{className:"mt-6 text-center space-y-3",children:[(0,r.jsxs)("p",{className:"text-gray-600",children:["N\xe3o tem uma conta?"," ",(0,r.jsx)(l(),{href:"/cadastro",className:"text-blue-500 hover:text-blue-600 font-medium",children:"Cadastre-se"})]}),(0,r.jsx)("div",{className:"pt-4 border-t border-gray-100",children:(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Sistema de Controle de Estoque"})})]})]}),(0,r.jsx)("div",{className:"mt-6 bg-white/50 backdrop-blur rounded-xl p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,r.jsx)("i",{className:"ri-admin-line text-blue-500"})," Acesso Administrativo"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Email: entregasobral@gmail.com",(0,r.jsx)("br",{}),"Senha: tenderbr0"]})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[754,441,684,358],()=>t(5052)),_N_E=e.O()}]);